- Pattern Match ████████████████████████████████████████████████████████████ 148
- Semantic Grep  16

njsscan: v0.4.3 | Ajin Abraham | opensecurity.in
╒═════════════╤═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ ejs_ect_template                                                                                                                    │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')                                        │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A1: Injection                                                                                                                       │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ The EJS/ECT template has an unescaped variable. Untrusted user input passed to this variable results in Cross Site Scripting (XSS). │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ ERROR                                                                                                                               │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤═══════════════════════════════════════╕                                                                          │
│             │ │ File           │ dvna/views/app/products.ejs           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match Position │ 1907 - 1937                           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Line Number(s) │ 51                                    │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match String   │ <%- output.products[i].code %>        │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ File           │ dvna/views/app/products.ejs           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match Position │ 2019 - 2056                           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Line Number(s) │ 53                                    │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match String   │ <%- output.products[i].description %> │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ File           │ dvna/views/app/products.ejs           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match Position │ 1797 - 1825                           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Line Number(s) │ 49                                    │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match String   │ <%- output.products[i].id %>          │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ File           │ dvna/views/app/products.ejs           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match Position │ 1851 - 1881                           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Line Number(s) │ 50                                    │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match String   │ <%- output.products[i].name %>        │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ File           │ dvna/views/app/products.ejs           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match Position │ 1963 - 1993                           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Line Number(s) │ 52                                    │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match String   │ <%- output.products[i].tags %>        │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ File           │ dvna/views/app/products.ejs           │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match Position │ 721 - 745                             │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Line Number(s) │ 20                                    │                                                                          │
│             │ ├────────────────┼───────────────────────────────────────┤                                                                          │
│             │ │ Match String   │ <%- output.searchTerm %>              │                                                                          │
│             │ ╘════════════════╧═══════════════════════════════════════╛                                                                          │
╘═════════════╧═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ sequelize_tls                                                                                                                                             │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ CWE-319: Cleartext Transmission of Sensitive Information                                                                                                  │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A6: Security Misconfiguration                                                                                                                             │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ The Sequelize connection string indicates that database server does not use TLS. Non TLS connections are susceptible to man in the middle (MITM) attacks. │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ WARNING                                                                                                                                                   │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤═══════════════════════════════════════════════╕                                                                                        │
│             │ │ File           │ dvna/config/db.js                             │                                                                                        │
│             │ ├────────────────┼───────────────────────────────────────────────┤                                                                                        │
│             │ │ Match Position │ 18 - 2                                        │                                                                                        │
│             │ ├────────────────┼───────────────────────────────────────────────┤                                                                                        │
│             │ │ Line Number(s) │ 1: 8                                          │                                                                                        │
│             │ ├────────────────┼───────────────────────────────────────────────┤                                                                                        │
│             │ │ Match String   │ module.exports = {                            │                                                                                        │
│             │ │                │   username: process.env.MYSQL_USER,           │                                                                                        │
│             │ │                │   password: process.env.MYSQL_PASSWORD,       │                                                                                        │
│             │ │                │   database: process.env.MYSQL_DATABASE,       │                                                                                        │
│             │ │                │   host: process.env.MYSQL_HOST || 'mysql-db', │                                                                                        │
│             │ │                │   port: process.env.MYSQL_PORT || 3306,       │                                                                                        │
│             │ │                │   dialect: 'mysql'                            │                                                                                        │
│             │ │                │ }                                             │                                                                                        │
│             │ ╘════════════════╧═══════════════════════════════════════════════╛                                                                                        │
╘═════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ express_open_redirect                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ CWE-601: URL Redirection to Untrusted Site ('Open Redirect')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A1: Injection                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ Untrusted user input in redirect() can result in Open Redirect vulnerability. An http parameter may contain a URL value and could cause the web application to redirect the request to the specified URL. By modifying the URL value to a malicious site, an attacker may successfully launch a phishing scam and steal user credentials. Because the server name in the modified link is identical to the original site, phishing attempts have a more trustworthy appearance. Whether this issue poses a vulnerability will be subject to the intended behavior of the application. For example, a search engine might intentionally provide redirects to arbitrary URLs. │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ ERROR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤═════════════════════════════╕                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            │
│             │ │ File           │ dvna/core/appHandler.js     │                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            │
│             │ │ Match Position │ 3 - 30                      │                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            │
│             │ │ Line Number(s) │ 188                         │                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            │
│             │ │ Match String   │ res.redirect(req.query.url) │                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            │
│             │ ╘════════════════╧═════════════════════════════╛                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            │
╘═════════════╧═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ node_deserialize                                                                                                             │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ CWE-502: Deserialization of Untrusted Data                                                                                   │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A8: Insecure Deserialization                                                                                                 │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ User controlled data in 'unserialize()' or 'deserialize()' function can result in Object Injection or Remote Code Injection. │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ ERROR                                                                                                                        │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤════════════════════════════════════════════════════════════════════════════════╕                          │
│             │ │ File           │ dvna/core/appHandler.js                                                        │                          │
│             │ ├────────────────┼────────────────────────────────────────────────────────────────────────────────┤                          │
│             │ │ Match Position │ 18 - 81                                                                        │                          │
│             │ ├────────────────┼────────────────────────────────────────────────────────────────────────────────┤                          │
│             │ │ Line Number(s) │ 218                                                                            │                          │
│             │ ├────────────────┼────────────────────────────────────────────────────────────────────────────────┤                          │
│             │ │ Match String   │ var products = serialize.unserialize(req.files.products.data.toString('utf8')) │                          │
│             │ ╘════════════════╧════════════════════════════════════════════════════════════════════════════════╛                          │
╘═════════════╧══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ node_xxe                                                                                                                          │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ CWE-611: Improper Restriction of XML External Entity Reference                                                                    │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A4: XML External Entities (XXE)                                                                                                   │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ User controlled data in XML parsers can result in XML External or Internal Entity (XXE) Processing vulnerabilities                │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ ERROR                                                                                                                             │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤══════════════════════════════════════════════════════════════════════════════════════════════════════════════╕ │
│             │ │ File           │ dvna/core/appHandler.js                                                                                      │ │
│             │ ├────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ │
│             │ │ Match Position │ 18 - 111                                                                                                     │ │
│             │ ├────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ │
│             │ │ Line Number(s) │ 235                                                                                                          │ │
│             │ ├────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ │
│             │ │ Match String   │ var products = libxmljs.parseXmlString(req.files.products.data.toString('utf8'), {noent:true,noblanks:true}) │ │
│             │ ╘════════════════╧══════════════════════════════════════════════════════════════════════════════════════════════════════════════╛ │
╘═════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ express_lfr_warning                                                                                            │
├─────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ CWE-23: Relative Path Traversal                                                                                │
├─────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A5: Broken Access Control                                                                                      │
├─────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ Untrusted user input in express render() function can result in arbitrary file read if hbs templating is used. │
├─────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ WARNING                                                                                                        │
├─────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤══════════════════════════════════════════════════════════╕                                  │
│             │ │ File           │ dvna/routes/app.js                                       │                                  │
│             │ ├────────────────┼──────────────────────────────────────────────────────────┤                                  │
│             │ │ Match Position │ 9 - 65                                                   │                                  │
│             │ ├────────────────┼──────────────────────────────────────────────────────────┤                                  │
│             │ │ Line Number(s) │ 23                                                       │                                  │
│             │ ├────────────────┼──────────────────────────────────────────────────────────┤                                  │
│             │ │ Match String   │ res.render('app/bulkproducts',{legacy:req.query.legacy}) │                                  │
│             │ ├────────────────┼──────────────────────────────────────────────────────────┤                                  │
│             │ │ File           │ dvna/routes/app.js                                       │                                  │
│             │ ├────────────────┼──────────────────────────────────────────────────────────┤                                  │
│             │ │ Match Position │ 9 - 11                                                   │                                  │
│             │ ├────────────────┼──────────────────────────────────────────────────────────┤                                  │
│             │ │ Line Number(s) │ 37: 39                                                   │                                  │
│             │ ├────────────────┼──────────────────────────────────────────────────────────┤                                  │
│             │ │ Match String   │ res.render('app/admin', {                                │                                  │
│             │ │                │             admin: (req.user.role == 'admin')            │                                  │
│             │ │                │         })                                               │                                  │
│             │ ╘════════════════╧══════════════════════════════════════════════════════════╛                                  │
╘═════════════╧════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ cookie_session_default                                                                                                              │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ CWE-522: Insufficiently Protected Credentials                                                                                       │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A2: Broken Authentication                                                                                                           │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ Consider changing the default session cookie name. An attacker can use it to fingerprint the server and target attacks accordingly. │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ INFO                                                                                                                                │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤═════════════════════════════╕                                                                                    │
│             │ │ File           │ dvna/server.js              │                                                                                    │
│             │ ├────────────────┼─────────────────────────────┤                                                                                    │
│             │ │ Match Position │ 9 - 3                       │                                                                                    │
│             │ ├────────────────┼─────────────────────────────┤                                                                                    │
│             │ │ Line Number(s) │ 23: 28                      │                                                                                    │
│             │ ├────────────────┼─────────────────────────────┤                                                                                    │
│             │ │ Match String   │ app.use(session({           │                                                                                    │
│             │ │                │   secret: 'keyboard cat',   │                                                                                    │
│             │ │                │   resave: true,             │                                                                                    │
│             │ │                │   saveUninitialized: true,  │                                                                                    │
│             │ │                │   cookie: { secure: false } │                                                                                    │
│             │ │                │ }))                         │                                                                                    │
│             │ ╘════════════════╧═════════════════════════════╛                                                                                    │
╘═════════════╧═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ cookie_session_no_domain                                                                                                                                                                                                                 │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ CWE-522: Insufficiently Protected Credentials                                                                                                                                                                                            │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A2: Broken Authentication                                                                                                                                                                                                                │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ Default session middleware settings: `domain` not set. It indicates the domain of the cookie; use it to compare against the domain of the server in which the URL is being requested. If they match, then check the path attribute next. │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ INFO                                                                                                                                                                                                                                     │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤═════════════════════════════╕                                                                                                                                                                                         │
│             │ │ File           │ dvna/server.js              │                                                                                                                                                                                         │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                                                                         │
│             │ │ Match Position │ 9 - 3                       │                                                                                                                                                                                         │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                                                                         │
│             │ │ Line Number(s) │ 23: 28                      │                                                                                                                                                                                         │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                                                                         │
│             │ │ Match String   │ app.use(session({           │                                                                                                                                                                                         │
│             │ │                │   secret: 'keyboard cat',   │                                                                                                                                                                                         │
│             │ │                │   resave: true,             │                                                                                                                                                                                         │
│             │ │                │   saveUninitialized: true,  │                                                                                                                                                                                         │
│             │ │                │   cookie: { secure: false } │                                                                                                                                                                                         │
│             │ │                │ }))                         │                                                                                                                                                                                         │
│             │ ╘════════════════╧═════════════════════════════╛                                                                                                                                                                                         │
╘═════════════╧══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤═══════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ cookie_session_no_maxage                                                                  │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ CWE-613: Insufficient Session Expiration                                                  │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A2: Broken Authentication                                                                 │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ Session middleware settings: `maxAge` not set. Use it to set expiration date for cookies. │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ INFO                                                                                      │
├─────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤═════════════════════════════╕                                          │
│             │ │ File           │ dvna/server.js              │                                          │
│             │ ├────────────────┼─────────────────────────────┤                                          │
│             │ │ Match Position │ 9 - 3                       │                                          │
│             │ ├────────────────┼─────────────────────────────┤                                          │
│             │ │ Line Number(s) │ 23: 28                      │                                          │
│             │ ├────────────────┼─────────────────────────────┤                                          │
│             │ │ Match String   │ app.use(session({           │                                          │
│             │ │                │   secret: 'keyboard cat',   │                                          │
│             │ │                │   resave: true,             │                                          │
│             │ │                │   saveUninitialized: true,  │                                          │
│             │ │                │   cookie: { secure: false } │                                          │
│             │ │                │ }))                         │                                          │
│             │ ╘════════════════╧═════════════════════════════╛                                          │
╘═════════════╧═══════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ cookie_session_no_path                                                                                                                                                                               │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ CWE-522: Insufficiently Protected Credentials                                                                                                                                                        │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A2: Broken Authentication                                                                                                                                                                            │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ Default session middleware settings: `path` not set. It indicates the path of the cookie; use it to compare against the request path. If this and domain match, then send the cookie in the request. │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ INFO                                                                                                                                                                                                 │
├─────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤═════════════════════════════╕                                                                                                                                                     │
│             │ │ File           │ dvna/server.js              │                                                                                                                                                     │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                                     │
│             │ │ Match Position │ 9 - 3                       │                                                                                                                                                     │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                                     │
│             │ │ Line Number(s) │ 23: 28                      │                                                                                                                                                     │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                                     │
│             │ │ Match String   │ app.use(session({           │                                                                                                                                                     │
│             │ │                │   secret: 'keyboard cat',   │                                                                                                                                                     │
│             │ │                │   resave: true,             │                                                                                                                                                     │
│             │ │                │   saveUninitialized: true,  │                                                                                                                                                     │
│             │ │                │   cookie: { secure: false } │                                                                                                                                                     │
│             │ │                │ }))                         │                                                                                                                                                     │
│             │ ╘════════════════╧═════════════════════════════╛                                                                                                                                                     │
╘═════════════╧══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ cookie_session_no_samesite                                                                                                                                                         │
├─────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ cwe-1275                                                                                                                                                                           │
├─────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A2: Broken Authentication                                                                                                                                                          │
├─────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ Default session middleware settings: `sameSite` attribute is not configured to strict or lax. These configurations provides protection against Cross Site Request Forgery attacks. │
├─────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ WARNING                                                                                                                                                                            │
├─────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤═════════════════════════════╕                                                                                                                                   │
│             │ │ File           │ dvna/server.js              │                                                                                                                                   │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                   │
│             │ │ Match Position │ 9 - 3                       │                                                                                                                                   │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                   │
│             │ │ Line Number(s) │ 23: 28                      │                                                                                                                                   │
│             │ ├────────────────┼─────────────────────────────┤                                                                                                                                   │
│             │ │ Match String   │ app.use(session({           │                                                                                                                                   │
│             │ │                │   secret: 'keyboard cat',   │                                                                                                                                   │
│             │ │                │   resave: true,             │                                                                                                                                   │
│             │ │                │   saveUninitialized: true,  │                                                                                                                                   │
│             │ │                │   cookie: { secure: false } │                                                                                                                                   │
│             │ │                │ }))                         │                                                                                                                                   │
│             │ ╘════════════════╧═════════════════════════════╛                                                                                                                                   │
╘═════════════╧════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
╒═════════════╤═════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ RULE ID     │ cookie_session_no_secure                                                                                        │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ CWE         │ cwe-614                                                                                                         │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ OWASP-WEB   │ A2: Broken Authentication                                                                                       │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ DESCRIPTION │ Default session middleware settings: `secure` not set. It ensures the browser only sends the cookie over HTTPS. │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ SEVERITY    │ WARNING                                                                                                         │
├─────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ FILES       │ ╒════════════════╤═════════════════════════════╕                                                                │
│             │ │ File           │ dvna/server.js              │                                                                │
│             │ ├────────────────┼─────────────────────────────┤                                                                │
│             │ │ Match Position │ 9 - 3                       │                                                                │
│             │ ├────────────────┼─────────────────────────────┤                                                                │
│             │ │ Line Number(s) │ 23: 28                      │                                                                │
│             │ ├────────────────┼─────────────────────────────┤                                                                │
│             │ │ Match String   │ app.use(session({           │                                                                │
│             │ │                │   secret: 'keyboard cat',   │                                                                │
│             │ │                │   resave: true,             │                                                                │
│             │ │                │   saveUninitialized: true,  │                                                                │
│             │ │                │   cookie: { secure: false } │                                                                │
│             │ │                │ }))                         │                                                                │
│             │ ╘════════════════╧═════════════════════════════╛                                                                │
╘═════════════╧═════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛